[
    {
        "Query": "Lấy danh sách mã chứng khoán có doanh thu hoạt động môi giới chứng khoán lớn hơn 10000 trong quý 1 năm 2023.",
        "Eng_query": "Retrieve a list of stock codes with securities brokerage revenue greater than 10000 in the first quarter of 2023.",
        "SQL": "SELECT code FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE quy = 1 AND nam = 2023 AND doanhthuhoatdongmoigioick > 10000",
        "Type": "where",
        "gen_SQL": "SELECT ttck.code FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly ttck WHERE ttck.doanhthuhoatdongmoigioick > 10000 AND ttck.quy = 1 AND ttck.nam = 2023 ORDER BY ttck.code NULLS LAST;"
    },
    {
        "Query": "Tổng doanh thu hoạt động môi giới chứng khoán theo từng quý trong năm 2023.",
        "Eng_query": "Total securities brokerage revenue by quarter in 2023.",
        "SQL": "SELECT quy, SUM(doanhthuhoatdongmoigioick) as tongDoanhThu FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE nam = 2023 GROUP BY quy",
        "Type": "group_by",
        "gen_SQL": "SELECT SUM(ttck.doanhthuhoatdongtc) AS total_revenue FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly ttck WHERE ttck.nam = 2023;"
    },
    {
        "Query": "Liệt kê mã chứng khoán và doanh thu hoạt động môi giới chứng khoán từ cao đến thấp trong quý 2 năm 2023.",
        "Eng_query": "List stock codes and securities brokerage revenue from highest to lowest in the second quarter of 2023.",
        "SQL": "SELECT code, doanhthuhoatdongmoigioick FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE quy = 2 AND nam = 2023 ORDER BY doanhthuhoatdongmoigioick DESC",
        "Type": "order_by",
        "gen_SQL": "SELECT ttck.code, ttck.doanhthuhoatdongmoigioick FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly ttck WHERE ttck.quy = 2 AND ttck.nam = 2023 ORDER BY ttck.doanhthuhoatdongmoigioick DESC NULLS LAST;"
    },
    {
        "Query": "Tìm mã chứng khoán có doanh thu hoạt động môi giới chứng khoán tăng cao nhất từ quý 1 đến quý 2 năm 2023.",
        "Eng_query": "Find the stock code with the highest increase in securities brokerage revenue from the first to the second quarter of 2023.",
        "SQL": "WITH Q1 AS (SELECT code, doanhthuhoatdongmoigioick as Q1Revenue FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE quy = 1 AND nam = 2023), Q2 AS (SELECT code, doanhthuhoatdongmoigioick as Q2Revenue FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE quy = 2 AND nam = 2023) SELECT Q1.code FROM Q1 JOIN Q2 ON Q1.code = Q2.code ORDER BY Q2.Q2Revenue - Q1.Q1Revenue DESC LIMIT 1",
        "Type": "date",
        "gen_SQL": "SELECT ttck.code, (ttck.doanhthuhoatdongtuc - LAG(ttck.doanhthuhoatdongtuc, 1) OVER (PARTITION BY ttck.code ORDER BY ttck.quy)) / NULLIF(LAG(ttck.doanhthuhoatdongtuc, 1) OVER (PARTITION BY ttck.code ORDER BY ttck.quy), 0) AS percentage_change FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly ttck WHERE ttck.quy IN (1, 2) AND ttck.nam = 2023 ORDER BY percentage_change DESC NULLS LAST LIMIT 1;"
    },
    {
        "Query": "Tính tỷ lệ doanh thu hoạt động môi giới chứng khoán trên tổng doanh thu của mỗi mã chứng khoán trong quý 4 năm 2023.",
        "Eng_query": "Calculate the ratio of securities brokerage revenue to total revenue for each stock code in the fourth quarter of 2023.",
        "SQL": "SELECT code, (doanhthuhoatdongmoigioick / SUM(doanhthuhoatdongmoigioick) OVER()) * 100 as tyLe FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE quy = 4 AND nam = 2023",
        "Type": "ratio",
        "gen_SQL": "SELECT ttck.code, SUM(ttck.doanhthuhoatdongmoigioick)::FLOAT / NULLIF(SUM(ttck.doanhthuhoatdong), 0) AS ratio FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly ttck WHERE ttck.quy = 4 AND ttck.nam = 2023 GROUP BY ttck.code ORDER BY ratio NULLS LAST;"
    },
    {
        "Query": "Liệt kê mã chứng khoán có lợi nhuận sau thuế dương trong quý 3 năm 2023.",
        "Eng_query": "List stock codes with positive net profit in the third quarter of 2023.",
        "SQL": "SELECT code FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE quy = 3 AND nam = 2023 AND lnsauthue > 0",
        "Type": "where",
        "gen_SQL": "SELECT ttck.code FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly ttck WHERE ttck.quy = 3 AND ttck.nam = 2023 AND ttck.lndathuchien_pl > 0 ORDER BY ttck.code NULLS LAST;"
    },
    {
        "Query": "Tính tổng lợi nhuận sau thuế theo từng năm.",
        "Eng_query": "Calculate total net profit by year.",
        "SQL": "SELECT nam, SUM(lnsauthue) as tongLai FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly GROUP BY nam",
        "Type": "group_by",
        "gen_SQL": "SELECT t.nam, SUM(t.lngop - t.cptc) AS net_profit FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly t GROUP BY t.nam ORDER BY t.nam NULLS LAST;"
    },
    {
        "Query": "Liệt kê top 3 mã chứng khoán có lợi nhuận sau thuế cao nhất trong năm 2023.",
        "Eng_query": "List the top 3 stock codes with the highest net profit in 2023.",
        "SQL": "SELECT code, lnsauthue FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE nam = 2023 ORDER BY lnsauthue DESC LIMIT 3",
        "Type": "order_by",
        "gen_SQL": "SELECT ttck.code, ttck.lndathuchien_pl, ttck.lnchuathuchien_pl FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly ttck WHERE ttck.nam = 2023 ORDER BY ttck.lndathuchien_pl DESC, ttck.lnchuathuchien_pl DESC LIMIT 3;"
    },
    {
        "Query": "Tìm mã chứng khoán có doanh thu từ tư vấn đầu tư chứng khoán tăng cao nhất từ quý 3 đến quý 4 năm 2023.",
        "Eng_query": "Find the stock code with the highest increase in securities investment consulting revenue from the third to the fourth quarter of 2023.",
        "SQL": "WITH Q3 AS (SELECT code, doanhthutuvandautuck as Q3Revenue FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE quy = 3 AND nam = 2023), Q4 AS (SELECT code, doanhthutuvandautuck as Q4Revenue FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE quy = 4 AND nam = 2023) SELECT Q3.code FROM Q3 JOIN Q4 ON Q3.code = Q4.code ORDER BY Q4.Q4Revenue - Q3.Q3Revenue DESC LIMIT 1",
        "Type": "date",
        "gen_SQL": "SELECT t.code, SUM(t.doanhthutuvandautuck) AS total_revenue FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly t WHERE t.quy IN (3, 4) AND t.nam = 2023 GROUP BY t.code ORDER BY total_revenue DESC NULLS LAST LIMIT 1;"
    },
    {
        "Query": "Tính tỷ lệ lợi nhuận sau thuế trên tổng doanh thu cho mỗi mã chứng khoan trong năm 2023.",
        "Eng_query": "Calculate the ratio of net profit to total revenue for each stock code in 2023.",
        "SQL": "SELECT code, (lnsauthue / SUM(lnsauthue) OVER()) * 100 as tyLeLai FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE nam = 2023",
        "Type": "ratio",
        "gen_SQL": "SELECT ttck.code, SUM(ttck.lngop) / NULLIF(SUM(ttck.doanhthuhoatdong), 0) AS net_profit_to_revenue_ratio FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly ttck WHERE ttck.nam = 2023 GROUP BY ttck.code ORDER BY net_profit_to_revenue_ratio DESC NULLS LAST;"
    },
    {
        "Query": "Liệt kê mã chứng khoán có chi phí hoạt động dưới 5000 trong quý 4 năm 2023.",
        "Eng_query": "List stock codes with operating expenses below 5000 in the fourth quarter of 2023.",
        "SQL": "SELECT code FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE quy = 4 AND nam = 2023 AND cphoatdong < 5000",
        "Type": "where",
        "gen_SQL": "SELECT ttck.code FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly ttck WHERE ttck.cphoatdong < 5000 AND ttck.quy = 4 AND ttck.nam = 2023 ORDER BY ttck.code NULLS LAST;"
    },
    {
        "Query": "Tính tổng chi phí hoạt động theo từng quý trong năm 2023.",
        "Eng_query": "Calculate total operating expenses by quarter in 2023.",
        "SQL": "SELECT quy, SUM(cphoatdong) as tongChiPhi FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE nam = 2023 GROUP BY quy",
        "Type": "group_by",
        "gen_SQL": "SELECT ttck.quy, SUM(ttck.cphoatdong) AS total_operating_expenses FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly ttck WHERE ttck.nam = 2023 GROUP BY ttck.quy ORDER BY ttck.quy NULLS LAST;"
    },
    {
        "Query": "Liệt kê 5 mã chứng khoán có chi phí hoạt động thấp nhất trong năm 2023.",
        "Eng_query": "List the 5 stock codes with the lowest operating expenses in 2023.",
        "SQL": "SELECT code, cphoatdong FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE nam = 2023 ORDER BY cphoatdong ASC LIMIT 5",
        "Type": "order_by",
        "gen_SQL": "SELECT ttck.code, ttck.cphoatdong FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly ttck WHERE ttck.nam = 2023 ORDER BY ttck.cphoatdong ASC NULLS LAST LIMIT 5;"
    },
    {
        "Query": "Tìm mã chứng khoán có sự tăng trưởng doanh thu từ hoạt động bảo lãnh, đại lý phát hành chứng khoán từ quý 2 đến quý 3 năm 2023.",
        "Eng_query": "Find the stock code with the highest growth in revenue from underwriting and securities issuance agency activities from the second to the third quarter of 2023.",
        "SQL": "WITH Q2 AS (SELECT code, doanhthubaolanhdailyphathanhck as Q2Revenue FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE quy = 2 AND nam = 2023), Q3 AS (SELECT code, doanhthubaolanhdailyphathanhck as Q3Revenue FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE quy = 3 AND nam = 2023) SELECT Q2.code FROM Q2 JOIN Q3 ON Q2.code = Q3.code ORDER BY Q3.Q3Revenue - Q2.Q2Revenue DESC LIMIT 1",
        "Type": "date",
        "gen_SQL": "SELECT ttck.code, SUM(ttck.doanhthuhoatdong) AS total_revenue FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly ttck WHERE ttck.quy BETWEEN 2 AND 3 AND ttck.nam = 2023 GROUP BY ttck.code ORDER BY total_revenue DESC NULLS LAST LIMIT 1;"
    },
    {
        "Query": "Tính tỷ lệ chi phí hoạt động trên tổng chi phí hoạt động của tất cả các mã chứng khoán trong quý 1 năm 2023.",
        "Eng_query": "Calculate the ratio of operating expenses to total operating expenses for all stock codes in the first quarter of 2023.",
        "SQL": "SELECT code, (cphoatdong / SUM(cphoatdong) OVER()) * 100 as tyLeChiPhi FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE quy = 1 AND nam = 2023",
        "Type": "ratio",
        "gen_SQL": "SELECT SUM(cphoatdong) AS total_operating_expenses, SUM(cphoatdongtudoanh) AS total_investment_expenses, SUM(cphoatdongtuvantc) AS total_financial_consulting_expenses, SUM(cphoatdongdaugiauythac) AS total_auction_trust_expenses, SUM(cphoatdongkhac) AS total_other_expenses, SUM(cphoatdongtudoanh) + SUM(cphoatdongtuvantc) + SUM(cphoatdongdaugiauythac) + SUM(cphoatdongkhac) AS total_expenses FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE quy = 1 AND nam = 2023;"
    },
    {
        "Query": "Liệt kê mã chứng khoán với doanh thu hoạt động tài chính lớn hơn 20000 trong quý 1 năm 2023.",
        "Eng_query": "List stock codes with financial operating revenue greater than 20000 in the first quarter of 2023.",
        "SQL": "SELECT code FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE quy = 1 AND nam = 2023 AND doanhthuhoatdongtc > 20000",
        "Type": "where",
        "gen_SQL": "SELECT ttck.code FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly ttck WHERE ttck.quy = 1 AND ttck.nam = 2023 AND ttck.doanhthuhoatdong > 20000;"
    },
    {
        "Query": "Tổng doanh thu hoạt động tài chính theo từng năm.",
        "Eng_query": "Total financial operating revenue by year.",
        "SQL": "SELECT nam, SUM(doanhthuhoatdongtc) as tongDoanhThuTaiChinh FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly GROUP BY nam",
        "Type": "group_by",
        "gen_SQL": "SELECT SUM(ttck.doanhthuhoatdong) AS total_operating_revenue FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly ttck WHERE ttck.nam = 2022;"
    },
    {
        "Query": "Liệt kê top 4 mã chứng khoán có doanh thu hoạt động tài chính cao nhất trong quý 3 năm 2023.",
        "Eng_query": "List the top 4 stock codes with the highest financial operating revenue in the third quarter of 2023.",
        "SQL": "SELECT code, doanhthuhoatdongtc FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE quy = 3 AND nam = 2023 ORDER BY doanhthuhoatdongtc DESC LIMIT 4",
        "Type": "order_by",
        "gen_SQL": "SELECT ttck.code, SUM(ttck.doanhthuhoatdong) AS total_operating_revenue FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly ttck WHERE ttck.quy = 3 AND ttck.nam = 2023 GROUP BY ttck.code ORDER BY total_operating_revenue DESC NULLS LAST LIMIT 4;"
    },
    {
        "Query": "Tìm mã chứng khoán có doanh thu từ hoạt động tư vấn tài chính tăng cao nhất từ quý 4 năm 2022 đến quý 1 năm 2023.",
        "Eng_query": "Find the stock code with the highest increase in financial consulting revenue from the fourth quarter of 2022 to the first quarter of 2023.",
        "SQL": "WITH Q4_2022 AS (SELECT code, doanhthuhoatdongtuvantc as Q4_2022Revenue FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE quy = 4 AND nam = 2022), Q1_2023 AS (SELECT code, doanhthuhoatdongtuvantc as Q1_2023Revenue FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE quy = 1 AND nam = 2023) SELECT Q4_2022.code FROM Q4_2022 JOIN Q1_2023 ON Q4_2022.code = Q1_2023.code ORDER BY Q1_2023.Q1_2023Revenue - Q4_2022.Q4_2022Revenue DESC LIMIT 1",
        "Type": "date",
        "gen_SQL": "SELECT ttck.code, (ttck.doanhthuhoatdongtuvantc - LAG(ttck.doanhthuhoatdongtuvantc, 1) OVER (PARTITION BY ttck.code ORDER BY ttck.quy)) / NULLIF(LAG(ttck.doanhthuhoatdongtuvantc, 1) OVER (PARTITION BY ttck.code ORDER BY ttck.quy), 0) AS percentage_change FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly ttck WHERE ttck.quy IN (4, 1) AND ttck.nam = 2023 ORDER BY percentage_change DESC NULLS LAST LIMIT 1;"
    },
    {
        "Query": "Tính tỷ lệ doanh thu từ hoạt động tư vấn tài chính trên tổng doanh thu từ tất cả hoạt động trong năm 2023.",
        "Eng_query": "Calculate the ratio of revenue from financial consulting activities to total revenue from all activities in 2023.",
        "SQL": "SELECT code, (doanhthuhoatdongtuvantc / SUM(doanhthuhoatdongtuvantc) OVER()) * 100 as tyLeDoanhThuTuVanTaiChinh FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly WHERE nam = 2023",
        "Type": "ratio",
        "gen_SQL": "SELECT SUM(ttck.doanhthutuvantc)::FLOAT / NULLIF(SUM(ttck.doanhthuhoatdong), 0) AS ratio FROM fact_period_bctc_ket_qua_kinh_doanh_chung_khoan_quarterly ttck WHERE ttck.nam = 2023;"
    }
]