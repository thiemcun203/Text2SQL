[
    {
      "Query": "Lấy danh sách mã chứng khoán có doanh thu hoạt động môi giới chứng khoán lớn hơn 10000 trong quý 1 năm 2023.",
      "SQL": "SELECT maChungKhoan FROM ThongTinChungKhoan WHERE quy = 1 AND nam = 2023 AND doanhthuhoatdongmoigioick > 10000",
      "Type": "where"
    },
    {
      "Query": "Tổng doanh thu hoạt động môi giới chứng khoán theo từng quý trong năm 2023.",
      "SQL": "SELECT quy, SUM(doanhthuhoatdongmoigioick) as tongDoanhThu FROM ThongTinChungKhoan WHERE nam = 2023 GROUP BY quy",
      "Type": "group_by"
    },
    {
      "Query": "Liệt kê mã chứng khoán và doanh thu hoạt động môi giới chứng khoán từ cao đến thấp trong quý 2 năm 2023.",
      "SQL": "SELECT maChungKhoan, doanhthuhoatdongmoigioick FROM ThongTinChungKhoan WHERE quy = 2 AND nam = 2023 ORDER BY doanhthuhoatdongmoigioick DESC",
      "Type": "order_by"
    },
    {
      "Query": "Tìm mã chứng khoán có doanh thu hoạt động môi giới chứng khoán tăng cao nhất từ quý 1 đến quý 2 năm 2023.",
      "SQL": "WITH Q1 AS (SELECT maChungKhoan, doanhthuhoatdongmoigioick as Q1Revenue FROM ThongTinChungKhoan WHERE quy = 1 AND nam = 2023), Q2 AS (SELECT maChungKhoan, doanhthuhoatdongmoigioick as Q2Revenue FROM ThongTinChungKhoan WHERE quy = 2 AND nam = 2023) SELECT Q1.maChungKhoan FROM Q1 JOIN Q2 ON Q1.maChungKhoan = Q2.maChungKhoan ORDER BY Q2.Q2Revenue - Q1.Q1Revenue DESC LIMIT 1",
      "Type": "date"
    },
    {
      "Query": "Tính tỷ lệ doanh thu hoạt động môi giới chứng khoán trên tổng doanh thu của mỗi mã chứng khoán trong quý 4 năm 2023.",
      "SQL": "SELECT maChungKhoan, (doanhthuhoatdongmoigioick / SUM(doanhthuhoatdongmoigioick) OVER()) * 100 as tyLe FROM ThongTinChungKhoan WHERE quy = 4 AND nam = 2023",
      "Type": "ratio"
    },
    {
      "Query": "Liệt kê mã chứng khoán có lợi nhuận sau thuế dương trong quý 3 năm 2023.",
      "SQL": "SELECT maChungKhoan FROM ThongTinChungKhoan WHERE quy = 3 AND nam = 2023 AND lnsauthue > 0",
      "Type": "where"
    },
    {
      "Query": "Tính tổng lợi nhuận sau thuế theo từng năm.",
      "SQL": "SELECT nam, SUM(lnsauthue) as tongLai FROM ThongTinChungKhoan GROUP BY nam",
      "Type": "group_by"
    },
    {
      "Query": "Liệt kê top 3 mã chứng khoán có lợi nhuận sau thuế cao nhất trong năm 2023.",
      "SQL": "SELECT maChungKhoan, lnsauthue FROM ThongTinChungKhoan WHERE nam = 2023 ORDER BY lnsauthue DESC LIMIT 3",
      "Type": "order_by"
    },
    {
      "Query": "Tìm mã chứng khoán có doanh thu từ tư vấn đầu tư chứng khoán tăng cao nhất từ quý 3 đến quý 4 năm 2023.",
      "SQL": "WITH Q3 AS (SELECT maChungKhoan, doanhthutuvandautuck as Q3Revenue FROM ThongTinChungKhoan WHERE quy = 3 AND nam = 2023), Q4 AS (SELECT maChungKhoan, doanhthutuvandautuck as Q4Revenue FROM ThongTinChungKhoan WHERE quy = 4 AND nam = 2023) SELECT Q3.maChungKhoan FROM Q3 JOIN Q4 ON Q3.maChungKhoan = Q4.maChungKhoan ORDER BY Q4.Q4Revenue - Q3.Q3Revenue DESC LIMIT 1",
      "Type": "date"
    },
    {
      "Query": "Tính tỷ lệ lợi nhuận sau thuế trên tổng doanh thu cho mỗi mã chứng khoan trong năm 2023.",
      "SQL": "SELECT maChungKhoan, (lnsauthue / SUM(lnsauthue) OVER()) * 100 as tyLeLai FROM ThongTinChungKhoan WHERE nam = 2023",
      "Type": "ratio"
    },
    {
      "Query": "Liệt kê mã chứng khoán có chi phí hoạt động dưới 5000 trong quý 4 năm 2023.",
      "SQL": "SELECT maChungKhoan FROM ThongTinChungKhoan WHERE quy = 4 AND nam = 2023 AND cphoatdong < 5000",
      "Type": "where"
    },
    {
      "Query": "Tính tổng chi phí hoạt động theo từng quý trong năm 2023.",
      "SQL": "SELECT quy, SUM(cphoatdong) as tongChiPhi FROM ThongTinChungKhoan WHERE nam = 2023 GROUP BY quy",
      "Type": "group_by"
    },
    {
      "Query": "Liệt kê 5 mã chứng khoán có chi phí hoạt động thấp nhất trong năm 2023.",
      "SQL": "SELECT maChungKhoan, cphoatdong FROM ThongTinChungKhoan WHERE nam = 2023 ORDER BY cphoatdong ASC LIMIT 5",
      "Type": "order_by"
    },
    {
      "Query": "Tìm mã chứng khoán có sự tăng trưởng doanh thu từ hoạt động bảo lãnh, đại lý phát hành chứng khoán từ quý 2 đến quý 3 năm 2023.",
      "SQL": "WITH Q2 AS (SELECT maChungKhoan, doanhthubaolanhdailyphathanhck as Q2Revenue FROM ThongTinChungKhoan WHERE quy = 2 AND nam = 2023), Q3 AS (SELECT maChungKhoan, doanhthubaolanhdailyphathanhck as Q3Revenue FROM ThongTinChungKhoan WHERE quy = 3 AND nam = 2023) SELECT Q2.maChungKhoan FROM Q2 JOIN Q3 ON Q2.maChungKhoan = Q3.maChungKhoan ORDER BY Q3.Q3Revenue - Q2.Q2Revenue DESC LIMIT 1",
      "Type": "date"
    },
    {
      "Query": "Tính tỷ lệ chi phí hoạt động trên tổng chi phí hoạt động của tất cả các mã chứng khoán trong quý 1 năm 2023.",
      "SQL": "SELECT maChungKhoan, (cphoatdong / SUM(cphoatdong) OVER()) * 100 as tyLeChiPhi FROM ThongTinChungKhoan WHERE quy = 1 AND nam = 2023",
      "Type": "ratio"
    },
    {
      "Query": "Liệt kê mã chứng khoán với doanh thu hoạt động tài chính lớn hơn 20000 trong quý 1 năm 2023.",
      "SQL": "SELECT maChungKhoan FROM ThongTinChungKhoan WHERE quy = 1 AND nam = 2023 AND doanhthuhoatdongtc > 20000",
      "Type": "where"
    },
    {
      "Query": "Tổng doanh thu hoạt động tài chính theo từng năm.",
      "SQL": "SELECT nam, SUM(doanhthuhoatdongtc) as tongDoanhThuTaiChinh FROM ThongTinChungKhoan GROUP BY nam",
      "Type": "group_by"
    },
    {
      "Query": "Liệt kê top 4 mã chứng khoán có doanh thu hoạt động tài chính cao nhất trong quý 3 năm 2023.",
      "SQL": "SELECT maChungKhoan, doanhthuhoatdongtc FROM ThongTinChungKhoan WHERE quy = 3 AND nam = 2023 ORDER BY doanhthuhoatdongtc DESC LIMIT 4",
      "Type": "order_by"
    },
    {
      "Query": "Tìm mã chứng khoán có doanh thu từ hoạt động tư vấn tài chính tăng cao nhất từ quý 4 năm 2022 đến quý 1 năm 2023.",
      "SQL": "WITH Q4_2022 AS (SELECT maChungKhoan, doanhthuhoatdongtuvantc as Q4_2022Revenue FROM ThongTinChungKhoan WHERE quy = 4 AND nam = 2022), Q1_2023 AS (SELECT maChungKhoan, doanhthuhoatdongtuvantc as Q1_2023Revenue FROM ThongTinChungKhoan WHERE quy = 1 AND nam = 2023) SELECT Q4_2022.maChungKhoan FROM Q4_2022 JOIN Q1_2023 ON Q4_2022.maChungKhoan = Q1_2023.maChungKhoan ORDER BY Q1_2023.Q1_2023Revenue - Q4_2022.Q4_2022Revenue DESC LIMIT 1",
      "Type": "date"
    },
    {
      "Query": "Tính tỷ lệ doanh thu từ hoạt động tư vấn tài chính trên tổng doanh thu từ tất cả hoạt động trong năm 2023.",
      "SQL": "SELECT maChungKhoan, (doanhthuhoatdongtuvantc / SUM(doanhthuhoatdongtuvantc) OVER()) * 100 as tyLeDoanhThuTuVanTaiChinh FROM ThongTinChungKhoan WHERE nam = 2023",
      "Type": "ratio"
    }
  ]
  